/* @license GPL-2.0-or-later https://www.drupal.org/licensing/faq */
(function(t,a){a.behaviors.bandeau_alerte={attach:function(i,e){t("div.field_alerte_sanitaire a").each(function(){t(this).attr("data-xiti-chapter-1","Page_d_accueil"),t(this).attr("data-xiti-chapter-2","Bandeau_d_alerte"),t(this).attr("data-xiti-type","navigation");});}};})(jQuery,Drupal);;
(function(i,u){var e=i(window).width()<992,s;s=function(){return "ontouchstart" in window;},u.behaviors.ameli_telecommande={attach:function(d,l){i(once("ameli_show_hide_telecommande",".telecommande-block-list",d)).each(function(){if(!e){var n=i(".telecommande-block-list ul"),t=".touchDeviceButton",o,f=1e4;i("body.page-front").length?o=setTimeout(function(){i(n).addClass("closed");},f):i(n).addClass("closed");}s()?(i(n).prepend('<li tabindex="0" class="touchDeviceButton"></li>'),i(t).on("click focusin",function(){i(n).removeClass("closed");}),i(document).on("click focusout blur",function(a){typeof n<"u"&&!i(a.target).is(n)&&!i.contains(i(n)[0],a.target)&&i(n).addClass("closed");})):(i(n).on("focusin mouseenter",function(){i(document).width()>=992&&(typeof o<"u"&&clearTimeout(o),i(this).removeClass("closed"));}),i(n).on("mouseleave focusout blur",function(){i(document).width()>=992&&i(this).addClass("closed");}));});}};})(jQuery,Drupal);;
(function(i,t){t.behaviors.ameli_link_block={attach:function(c,n){const a=i(window).width()<768;i([".node--type-demarches-frequentes",".bloc-bg-img-txt",".item-metier",".widget-outil",".card-radius",".card-radius-service",".card-radius-rs",".card-radius-border-rs",".paragraph-maladies-container",a?".blocRubrique":void 0].filter((e)=>e).join(),c).each(function(){i(this).off("click").on("click",function(e){const r=i(e.target);r.is("a")||r.parents("a").length||i(this).find("a")[0].click();});});}};})(jQuery,Drupal);;
(function(o,a,m){const n=o(window).width()<992;a.behaviors.ameli_sommaire_article={attach:function(r,p){o(once("ameli_sommaire_sticky",".view-sommaire-article",r)).each(function(){if(!n){const e=o(".view-sommaire-article");let t;if(e.length){const s=parseInt(e.offset().top,10),l=e.outerHeight();o(document).on("load scroll touchmove",function(){const i=o(".popup_bandeau_caisse_content");let c=i.length?s+i.outerHeight():s;t=o(window).scrollTop(),t>c?e.addClass("pos-fixed"):e.removeClass("pos-fixed"),parseInt(t-o(".footer").offset().top)+parseInt(l+100)>=0?e.addClass("pos-bottom"):e.removeClass("pos-bottom");}),o("body").scrollspy({target:"#menuSidebar",offset:100});}}});}};})(jQuery,Drupal,drupalSettings);;
(function(i,a){a.behaviors.ameli_access_transcription={attach:function(e,s){i(once("ameli_transcription_textuelle","body",e)).each(function(){i(".btn-transcription").on("click",function(){var r=i(this).attr("aria-expanded"),n=i(this).parents(".wrapper-transcription-textuelle");if(i(this).hasClass("btn-transcription-video"))var t="de la vidéo";else if(i(this).hasClass("btn-transcription-infographie"))var t="de l'infographie";else if(i(this).hasClass("btn-transcription-Audio"))var t="du fichier audio";else var t="de l'image";r=="false"?n.find("> .btn-transcription").text("Masquer la transcription textuelle "+t):n.find("> .btn-transcription").text("Lire la transcription textuelle "+t);});});}};})(jQuery,Drupal);;
(function(t,n){n.behaviors.ameli_accessibilite_modal={attach:function(i,e){t(once("ameli_modal_bootstrap","body",i)).each(function(){t(".modal").on("shown.bs.modal",function(a){t("#modalContent").find(".close").focus();});});}},n.behaviors.ameli_tarteaucitron_modal={attach:function(i,e){once("ameli_tarteaucitron_jscrollpane","html").length&&t(window).each(function(){this.addEventListener("tac.open_panel",function(){t("#tarteaucitronServices").jScrollPane();});});}},n.behaviors.ameli_accessibilite_ui_dialog={attach:function(i,e){t(once("ameli_ui_dialog","body",i)).each(function(){t(document).on("dialogopen",function(a,d){const o=t(".ui-dialog-title",a.target),c=t(".ui-dialog-title",a.target).attr("id"),l=t(".ui-dialog-title",a.target).attr("class");if(o.length){const s=o.text();o.replaceWith(`<h2 id="${c}" class="${l}">${s}</h2>`);}});});}};})(jQuery,Drupal);;
(function(c,s){s.behaviors.ameli_bloc_service={attach:function(n,t){c(once("ameli_btn_service","body",n)).each(function(){c(".services").each(function(){var o=c(this).find(".btn-service"),i=o.attr("data-color");o.find("a").css("color","#fff").hover(function(){c(this).css("color",i);},function(){c(this).css("color","#fff");}).focusin(function(){c(this).css("color",i);}).focusout(function(){c(this).css("color","#fff");});});});}};})(jQuery,Drupal);;
(function(e,s){s.behaviors.ameli_carousel_themes_sante={attach:function(a,i){e(once("ameli_theme_glossaire","body",a)).each(function(){var t=e(window).width()<1200;if(e(".tns-parent-glossaire").length&&!e(".tns-outer").length&&t){var n=e(".glossaire span.active").parent().index(),o=tns({container:".tns-parent-glossaire ul",items:8,slideBy:8,controls:!0,nav:!1,loop:!0,startIndex:n,controlsText:["<i class='icon-chevron'></i><span class='sr-only'>Précédent</span>","<i class='icon-chevron'></i><span class='sr-only'>Suivant</span>"],responsive:{1200:{disable:!0},768:{items:16,slideBy:16}}});tinySliderA11Y({tns:o,parent:".tns-parent-glossaire",parentLabelText:"Glossaire",navLabel:"Diapositive ",navCurrentLabel:"(Diapositive courante)"});}});}},s.behaviors.ameli_carousel_demarches_frequentes_home={attach:function(a,i){e(once("ameli_demarches_frequentes","body",a)).each(function(){var t=e(window).width()<1200;if(e(".tns-parent-demarches-frequentes").length&&!e(".tns-outer").length&&t){var n=tns({container:".tns-parent-demarches-frequentes",items:2,controls:!0,nav:!1,loop:!0,controlsText:["<i class='icon-chevron'></i><span class='sr-only'>Précédent</span>","<i class='icon-chevron'></i><span class='sr-only'>Suivant</span>"],responsive:{1200:{disable:!0},768:{items:4}}});tinySliderA11Y({tns:n,parent:".tns-parent-demarches-frequentes",parentLabelText:"Démarches fréquentes",navLabel:"Diapositive ",navCurrentLabel:"(Diapositive courante)"});}});}},s.behaviors.ameli_carousel_actus_home={attach:function(a,i){e(once("ameli_theme_actus","body",a)).each(function(){if(e(".tns-parent-actus-home-ameli:not(.tns-slider)").length){var t=tns({container:".tns-parent-actus-home-ameli",items:1,controls:!1,nav:!0,navPosition:"bottom",autoplay:!0,autoplayPosition:"bottom",loop:!0});t.events.on("transitionStart",function(n,o){if(e.each(n.navItems,function(l,c){this.removeAttribute("tabindex");}),s.ameli_xiti){var r=e(".tns-parent-actus-home-ameli").children("li").eq(n.displayIndex);r.hasClass("xiti-publisher-sent")||(s.ameli_xiti.send_publisher(n.slideItems[n.displayIndex].outerHTML),r.addClass("xiti-publisher-sent"));}}),tinySliderA11Y({tns:t,parent:".tns-parent-actus-home-ameli",parentLabelText:"Actualités",navLabel:"Diapositive ",navCurrentLabel:"(Diapositive courante)"});}});}},s.behaviors.ameli_carousel_zoom_sur_home={attach:function(a,i){e(once("ameli_zoom_sur","body",a)).each(function(){if(e(".tns-parent-zoom-sur-ameli:not(.tns-slider)").length){var t=tns({container:".tns-parent-zoom-sur-ameli",items:1,controls:!1,nav:!0,navPosition:"bottom",autoplay:!0,autoplayPosition:"bottom",loop:!0});tinySliderA11Y({tns:t,parent:".tns-parent-zoom-sur-ameli",parentLabelText:"Actualités",navLabel:"Diapositive ",navCurrentLabel:"(Diapositive courante)"});}});}},s.behaviors.ameli_carousel_pdcv_home={attach:function(a,i){e(once("ameli_pdcv",".tns-parent-pdcv-ameli:not(.tns-slider)")).each(function(){var t=document.querySelectorAll(".tns-parent-pdcv-ameli:not(.tns-slider)");t.forEach(function(n){const o=tns({container:n,items:1,controls:!0,controlsText:["<span class='sr-only'>Précédent</span>","<i class='icon-chevron'></i><span class='sr-only'>Suivant</span>"],nav:!1,loop:!0});tinySliderA11Y({tns:o,parent:".tns-parent-pdcv-ameli",parentLabelText:"Actualités Près de chez vous",navLabel:"Diapositive ",navCurrentLabel:"(Diapositive courante)"});});});}};})(jQuery,Drupal);;
(function(e,t){t.behaviors.ameli_filters={attach:function(i,o){e(once("ameli_filters_facets","body",i)).each(function(){var n=e(window).width()<992;n&&e(document).on("click",".filtre-btn-collapse",function(){e(this).parents(".facets-form-form").toggleClass("openFiltersPopin");});});}};})(jQuery,Drupal);;
(function(e,n){n.behaviors.ameli_scrollpanel={attach:function(l,a){e(once("ameli_enbref_jscrollpane",".enBref .scrollPanel")).each(function(){e(this).jScrollPane();});}};})(jQuery,Drupal);;
(function(t,a){a.behaviors.onomasticon_accesibilite={attach:function(s,r){t(once("onomasticon_accesibilite",".js-onomasticon",s)).each(function(){t(this).on("click",function(i){t(this).next().hasClass("js-onomasticon-term-description")?(t(this).next().remove(),t(this).removeAttr("aria-describedby")):o(t(this));}),t(this).on("mouseover",function(i){o(t(this));}),t(this).on("mouseleave",function(i){t(this).next().remove(),t(this).removeAttr("aria-describedby");});});function o(i){var e=100-i.width()/2;if(e>0?e=-Math.abs(e):e=Math.abs(e),t(window).width()<992){var c=i.offset().left,h=t(window).width()-(i.offset().left+i.outerWidth());c<100&&(e=e+100),h<100&&(e=e-100);}var n="onomasticon"+Math.floor(Math.random()*100);i.attr("aria-describedby",n),i.after(`<div  role="tooltip" style='position: absolute; top:2em;left:`+e+`px;' id="`+n+'" class="onomasticon-term-description js-onomasticon-term-description"><p>'+i.data("original-title")+"</p></div>");}}};})(jQuery,Drupal);;
(function(i,a){a.behaviors.ameli_equalHeight={attach:function(t,o){i(once("ameli_bloc_equel_height","body",t)).each(function(){if(i(".equalHeight").length){var e=0;i(".equalHeight").each(function(){i(this).height()>e&&(e=i(this).height());}),i(".equalHeight").height(e);}});}},a.behaviors.ameli_ij_accordeon={attach:function(t,o){i(once("ameli_accordeon_ij_calcul","body",t)).each(function(){if(i(".ij-form-choix").length){var e=i(".ij-form-choix").find(".wrapper-accordeon");e.find("button").on("click",function(){e.hasClass("open")?e.removeClass("open"):e.addClass("open");});}});}},a.behaviors.ameli_ij_tooltip={attach:function(t,o){i(once("ameli_accordeon_ij_tooltip_calcul","body",t)).each(function(){i(".ameli-simulateur-ij-ameli-simulateur-ij-calcul").length&&i('[data-toggle="tooltip"]').tooltip();});}};})(jQuery,Drupal);;
(function(e,n){n.behaviors.ameli_couche_accueil={attach:function(i,c){e(once("ameli_couche_infographie","body",i)).each(function(){e(".para_infographie, .node--type-couche-campagne-generique").length&&e(".para_infographie, .node--type-couche-campagne-generique").each(function(){var a=e(this).find(".h2-light-underline").attr("data-color");e(this).find(".wrapper-transcription-textuelle").find(".link, .btn-transcription").css("color",a);});});}};})(jQuery,Drupal);;
document.addEventListener("DOMContentLoaded",()=>{const l=document.querySelectorAll(".dropdown-with-overlay");if(l.length>0){for(const o of l){let s=function(){d.forEach(function(t){t.style.display="none";}),a.forEach(function(t){t.setAttribute("aria-expanded","false");}),e&&(e.style.display="none");};var u=s;const a=o.querySelectorAll("button"),d=o.querySelectorAll(".dropdown-submenu"),e=o.closest(".wrapper-dropdown-with-overlay").querySelector(".topbar__overlay");s(),a.forEach(function(t){t.onclick=function(){const n=document.getElementById(t.getAttribute("aria-controls")),c=n.style.display,r=this;this.closest(".dropdown-submenu")||s(),c==="none"?(n.style.display="block",e&&(e.style.display="block"),this.closest(".dropdown-submenu")||o.querySelectorAll('button[aria-expanded="true"]').forEach(function(i){i.setAttribute("aria-expanded","false");}),this.setAttribute("aria-expanded","true")):(n.style.display="none",this.setAttribute("aria-expanded","false"),e&&(e.style.display="none")),n.addEventListener("keydown",function(i){i.key==="Escape"&&(n.style.display="none",r.focus(),r.setAttribute("aria-expanded","false"),e&&(e.style.display="none"));});};}),window.addEventListener("click",function(t){t.target.closest(".dropdown-with-overlay")||s();});}}});;
(function(e,g){g.behaviors.ameli_menuMain={attach:function(i,s){this.initMenuAccordion(i,s),this.initMenuDialogs(i,s);},initMenuAccordion:function(i,s){var o=e(".accordions-group",i);o.each(function(){var f=e(this).find(".accordion");f.each(function(){var h=e(this).find(".heading-accordion"),c=e(this).find(".heading-accordion-back");h.each(function(){e(this).on("click",function(a){var d=e("#"+e(this).attr("aria-controls"));if(o.hasClass("close-others")&&e(this).attr("aria-expanded")==="false"){var n=f.find(".heading-accordion[aria-expanded=true]");n.attr("aria-expanded",!1),n.each(function(){var l=e("#"+e(this).attr("aria-controls"));l.removeClass("open");});}var r=e(this).attr("aria-expanded")==="true"||!1;e(this).attr("aria-expanded",!r),d.toggleClass("open");});}),c.each(function(){e(this).on("click",function(a){h.click();});});});});},initMenuDialogs:function(i,s){const o=i.querySelectorAll(".js-cta-open-dialog");if(o.length>0){for(const c of o){let l=function(){a.classList.add("dialog-backdrop--active"),d.focus(),document.querySelector("body").classList.add("has-dialog");},u=function(){a.classList.remove("dialog-backdrop--active"),document.querySelector("body").classList.remove("has-dialog");var t=document.querySelector(".menu-main .accordion .heading-accordion[aria-expanded=true]");if(t){var b=document.getElementById(t.getAttribute("aria-controls"));t.setAttribute("aria-expanded",!1),b.classList.remove("open");}c.focus();};var f=l,h=u;const a=document.getElementById(c.getAttribute("data-controls"));if(!a)continue;const d=a.querySelector(".dialog__close");let n=a.querySelectorAll(["[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"]):not([disabled]), details:not([disabled])'].join(",")),r=n.length-1;c.addEventListener("click",function(){l();}),d.addEventListener("click",function(){u();}),a.addEventListener("keydown",function(t){t.code==="Escape"?u():t.code==="Tab"&&(t.shiftKey?document.activeElement===n[0]&&(n[r].focus(),t.preventDefault()):document.activeElement===n[r]&&(n[0].focus(),t.preventDefault()));}),window.addEventListener("click",function(t){t.target.matches(".dialog-backdrop--active")&&u();});}}}};})(jQuery,Drupal);;
document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector(".alerte-sanitaire");if(e){let n=e.querySelector(".alerte-sanitaire__action"),l=e.querySelector(".alerte-sanitaire__content"),i=n.querySelectorAll("span"),o=i.length;n.onclick=function(){l.classList.toggle("pause");for(let t=0;t<o;t++)i[t].classList.toggle("hidden");};}});;
(function(e,i){var r=e(window).width()<992;i.behaviors.ameli_breadcrumb={attach:function(a,d){e(once("ameli_breadcrumb_mobile","body",a)).each(function(){if(r){var c=document.querySelector(".breadcrumb__btn"),t=document.querySelector(".breadcrumb__list");c.onclick=function(){t.classList.add("breadcrumb__list--opened"),this.classList.add("breadcrumb__btn--hidden"),this.setAttribute("aria-expanded","true"),t.querySelector("li:first-child a").focus();};}});}};})(jQuery,Drupal);;
(function($,Drupal,drupalSettings,window){Drupal.behaviors.ameli_orejime={attach:function(context,settings){$(once('ameli_orejime','a.tarte-au-citron-open-modal')).click(function(e){e.preventDefault();if(window.rgpd_orejime)window.rgpd_orejime.show();});}};}(jQuery,Drupal,drupalSettings,window));;
var tag_activated=false;(function($,Drupal,drupalSettings){Drupal.rgpd_orejime_piano=Drupal.rgpd_orejime_piano??{};Drupal.rgpd_orejime_piano.pianoMore=function(){tag_activated=true;var localisation=drupalSettings.ameli_xiti.localisation;if(null===localisation)localisation='';var document_referer=drupalSettings.ameli_xiti.referer;var other=drupalSettings.ameli_xiti.other;if(null===other)other='';var specialite=drupalSettings.ameli_xiti.specialite;if(null===specialite)specialite='';var cas_particulier=drupalSettings.ameli_xiti.cas_particulier;if(null===cas_particulier)cas_particulier='';var age=drupalSettings.ameli_xiti.age;if(null===age)age='';var code=drupalSettings.ameli_xiti.code;Drupal.ameli_xiti.set_properties({'visite_localisee':code,'caisse_rattachee':localisation,'version_site':'1','type_de_page':drupalSettings.ameli_xiti.type,'URL precedente':document_referer.replace(/\s/g,'+'),'organisme':other,'specialite':specialite,'cas_particulier':cas_particulier,'age':age});var reco_ctn=null;if(typeof drupalSettings.ameli_xiti.reco_ctn!=='undefined'&&drupalSettings.ameli_xiti.reco_ctn!=='')reco_ctn=drupalSettings.ameli_xiti.reco_ctn;var reco_keyword=null;if(typeof drupalSettings.ameli_xiti.reco_keyword!=='undefined'&&drupalSettings.ameli_xiti.reco_keyword!=='')reco_keyword=drupalSettings.ameli_xiti.reco_keyword;var reco_reference=null;if(typeof drupalSettings.ameli_xiti.reco_reference!=='undefined'&&drupalSettings.ameli_xiti.reco_reference!=='')reco_reference=drupalSettings.ameli_xiti.reco_reference;if(!(null==reco_ctn&&reco_keyword==null&&reco_reference==null))Drupal.ameli_xiti.send_pianoEvent('internal_search_result.display',{'ctn':reco_ctn,'ise_keyword':reco_keyword,'reference':reco_reference});Drupal.ameli_xiti.send_pianoEvent('page.display',{'page':drupalSettings.ameli_xiti.label,'site_level2':drupalSettings.ameli_xiti.level2,'type_de_page':drupalSettings.ameli_xiti.type,'page_chapter1':drupalSettings.ameli_xiti.chapters[0],'page_chapter2':drupalSettings.ameli_xiti.chapters[1],'page_chapter3':drupalSettings.ameli_xiti.chapters[2],'organisme':other,'specialite':specialite,'cas_particulier':cas_particulier,'age':age});Drupal.behaviors.ameli_xiti.attach(document,drupalSettings);var search_input=drupalSettings.ameli_xiti.search_input;var search_page=drupalSettings.ameli_xiti.search_page;var search_ctn=drupalSettings.ameli_xiti.search_ctn;var search_year=drupalSettings.ameli_xiti.search_year;var search_theme=drupalSettings.ameli_xiti.search_theme;var search_category=drupalSettings.ameli_xiti.search_category;var search_theme_form=drupalSettings.ameli_xiti.search_theme_form;if(undefined!==search_input||undefined!==search_page||undefined!==search_theme_form)Drupal.ameli_xiti.send_pianoEvent('internal_search_result.display',{'ise_keyword':search_input,'ise_page':search_page,'ctn':search_ctn,'ctn_year':search_year,'theme_recherche':search_theme,'theme_formulaire':search_theme_form,'category':search_category});};Drupal.ameli_xiti={send_pianoEvent:function(event_type,event_tags){if(typeof pa!=='undefined'){pa.privacy.include.property('site_level2',['exempt']);pa.privacy.include.property('type_de_page',['exempt']);pa.privacy.include.property('organisme',['exempt']);pa.sendEvent(event_type,event_tags);}},send_publisher:function(elem){var data=$(elem).data();if(typeof data['xitiCampaign']==='undefined'||data['xitiCampaign']===''||typeof data['xitiCreation']==='undefined'||data['xitiCreation']===''||typeof data['xitiVariant']==='undefined'||data['xitiVariant']==='')return;var dataXiti={};dataXiti['generalPlacement']=null;if(typeof data['xitiGeneralPlacement']!=='undefined'&&data['xitiGeneralPlacement']!=='')dataXiti['generalPlacement']='['+data['xitiGeneralPlacement']+']';dataXiti['detailedPlacement']=null;if(typeof data['xitiDetailedPlacement']!=='undefined'&&data['xitiDetailedPlacement']!=='')dataXiti['detailedPlacement']='['+data['xitiDetailedPlacement']+']';dataXiti['format']=null;if(typeof data['xitiFormat']!=='undefined'&&data['xitiFormat']!=='')dataXiti['format']='['+data['xitiFormat']+']';Drupal.ameli_xiti.send_pianoEvent('publisher.impression',{'onsitead_campaign':'['+data['xitiCampaign']+']','onsitead_creation':'['+data['xitiCreation']+']','onsitead_detailed_placement':dataXiti['detailedPlacement'],'onsitead_format':dataXiti['format'],'onsitead_general_placement':dataXiti['generalPlacement'],'onsitead_variant':'['+data['xitiVariant']+']'});},send_clicktag:function(elem){var data=$(elem).data();if(!tag_activated)return;var dataXiti={};dataXiti['chapter1']=null;if(typeof data['xitiChapter-1']!=='undefined'&&data['xitiChapter-1']!=='')dataXiti['chapter1']=data['xitiChapter-1'];dataXiti['chapter2']=null;if(typeof data['xitiChapter-2']!=='undefined'&&data['xitiChapter-2']!=='')dataXiti['chapter2']=data['xitiChapter-2'];dataXiti['chapter3']=null;if(typeof data['xitiChapter-3']!=='undefined'&&data['xitiChapter-3']!=='')dataXiti['chapter3']=data['xitiChapter-3'];Drupal.ameli_xiti.send_pianoEvent('page.display',{'click':data['xitiName'],'site_level2':typeof data['xitiLevel-2']!=='undefined'?data['xitiLevel-2']:null,'type_de_page':data['type'],'click_chapter1':dataXiti['chapter1'],'click_chapter2':dataXiti['chapter2'],'click_chapter3':dataXiti['chapter3']});},set_properties:function(attributes){if(typeof pa!=='undefined')pa.setProperties(attributes,{'persistent':true});}};Drupal.behaviors.ameli_xiti={attach:function(context,settings){$(once('ameli_xiti','[data-xiti-name]')).each(function(){var data=$(this).data();if(typeof data['xitiName']==='undefined'||data['xitiName']===''||typeof data['xitiType']==='undefined'||data['xitiType']==='')return;$(this).click(function(){data=$(this).data();if(!tag_activated)return;var dataXiti={};dataXiti['level2']=null;if(typeof data['xitiLevel-2']!=='undefined')dataXiti['level2']=data['xitiLevel-2']!==''?data['xitiLevel-2']:drupalSettings.ameli_xiti.level2;dataXiti['chapter1']=null;if(typeof data['xitiChapter-1']!=='undefined'&&data['xitiChapter-1']!=='')dataXiti['chapter1']=data['xitiChapter-1'];else{if(drupalSettings.ameli_xiti.node_title!==undefined)dataXiti['chapter1']=drupalSettings.ameli_xiti.node_title;}dataXiti['chapter2']=null;if(typeof data['xitiChapter-2']!=='undefined'&&data['xitiChapter-2']!=='')dataXiti['chapter2']=data['xitiChapter-2'];dataXiti['chapter3']=null;if(typeof data['xitiChapter-3']!=='undefined'&&data['xitiChapter-3']!=='')dataXiti['chapter3']=data['xitiChapter-3'];if('label_caisse'==data['xitiName']){var cookie=Drupal.ameli_localisation_cookie();if(cookie.localisation)data['xitiName']=$('div.localisation_txt_js').attr('data-label-xiti-localized');else data['xitiName']=$('div.localisation_txt_js').attr('data-label-xiti-no-localized');}Drupal.ameli_xiti.send_pianoEvent('click.'+data['xitiType'],{'click':data['xitiName'],'site_level2':String(dataXiti['level2']),'click_chapter1':dataXiti['chapter1'],'click_chapter2':dataXiti['chapter2'],'click_chapter3':dataXiti['chapter3']});});});$(once('ameli_xiti','[data-xiti-campaign][data-xiti-campaign-type="click"]')).each(function(){$(this).click(function(){Drupal.ameli_xiti.send_publisher(this);});});if(typeof pa!=='undefined')if('optin'==pa.privacy.getMode()&&tag_activated){$(once('ameli_xiti','[data-xiti-campaign][data-xiti-campaign-type="publish"]')).each(function(){Drupal.ameli_xiti.send_publisher(this);});var slide_active=$('.tns-parent-actus-home-ameli li.tns-slide-active');if(0<slide_active.length){Drupal.ameli_xiti.send_publisher(slide_active.get(0).outerHTML);slide_active.addClass('xiti-publisher-sent');}}}};}(jQuery,Drupal,drupalSettings));;
(function($,Drupal,drupalSettings,Cookies){Drupal.ameli_localisation_cookie=function(){var ret={localisation:undefined,counter:0};var localisation=Cookies.get('ameli_localisation');if(localisation)ret.localisation=localisation;var counter=Cookies.get('ameli_localisation_counter');if(counter)ret.counter=parseInt(counter);return ret;};Drupal.ameli_localisation=function(elem,data){this.data=data;this.counter_limit=1;this.checkAutoOpen=function(){if(this.localisationCookieData.localisation)return false;if(this.localisationCookieData.counter<this.counter_limit){this.localisationCookieData.counter++;Cookies.set('ameli_localisation_counter',this.localisationCookieData.counter,{expires:this.getExpirationCookieDate(),path:'/',sameSite:'Lax',secure:true});return true;}return false;};this.checkFocusOnLocalisationPopin=function(popin){if($(popin).val()==='')self.dialog.find(".step1 form button").prop("disabled",true);else self.dialog.find(".step1 form button").prop("disabled",false);};this.getExpirationCookieDate=function(){var date_now=new Date();return date_now.getDay()+365+30;};this.positionCenter=function(){this.dialog.dialog("option","position",this.dialog.dialog("option","position"));};this.checkPostalCode=function(val){if(!/^\d{5}$/.test(val))return false;var dep,fincp,cp=parseInt(val),res=[];if(cp<96000){dep=val.substring(0,2);fincp=val.substring(2);}else{dep=val.substring(0,3);fincp=val.substring(3);}if(this.data.pcOutDep[val]!==undefined)res=this.data.pcOutDep[val];else{if(this.data.dep[dep]!==undefined)res=this.data.dep[dep];}if(res.length===1)return res;else{if(res.length>1){var toReturn=[],self=this;$.each(res,function(key,tid){if($.inArray(fincp,self.data.terms[tid].bdi_cod)!==-1)toReturn.push(tid);});if(toReturn.length>0)return toReturn;else return res;}}return false;};this.checkLocalisation=function(){var selected=this.dialog.find('.step2 form input[name="localisation"]:checked');if(selected.length)return [selected.val()];return false;};this.resetStep=function(){this.dialog.find("form").each(function(){$(this)[0].reset();});this.showStep(1);};this.showStep=function(step,stepParams){var stepDialog=this.dialog.find(".step"+step);for(var i=1;i<=3;i++)if(i===step)this.dialog.find(".step"+i).show();else this.dialog.find(".step"+i).hide();if(step===1){stepDialog.find('.formHelp').show();stepDialog.find('.formErrors').hide();}if(step===2){var radiosContainer=stepDialog.find('.radio-localisation');$.each(stepParams,function(key,value){$('<input>').prop({id:'localisation-'+value,type:'radio',name:'localisation',value}).appendTo(radiosContainer);$('<label>').prop({'for':'localisation-'+value}).html(drupalSettings.ameli_localisation.terms[value].label).appendTo(radiosContainer);});stepDialog.find("form button").prop("disabled",true);stepDialog.find('.radio-localisation input[type=radio]').on('click',function(){stepDialog.find("form button").prop("disabled",false);});}else{var step2Dialog=this.dialog.find(".step2");step2Dialog.find('.radio-localisation').html('');}if(step===3){var label=this.data.terms[stepParams[0]].label;stepDialog.find('.local-caisse').html(label);stepDialog.find('input[name="localisation"]').val(stepParams[0]);stepDialog.find('button').focus();}else{var step3Dialog=this.dialog.find(".step3");step3Dialog.find('.local-caisse').html('');step3Dialog.find('input[name="localisation"]').val('');}this.dialog.dialog("option","title",stepDialog.data('title'));};this.open=function(){this.showStep(1);this.dialog.dialog("open");$('body').addClass('modal-open');};this.addTriggerElement=function(elem){$('.ameli-localisation-content-trigger',elem).on('click',function(e){e.preventDefault();self.open();});};this.localisationCookieData=Drupal.ameli_localisation_cookie();var self=this;this.dialog=$('.dialog',elem).dialog({autoOpen:false,draggable:false,resizable:false,width:'auto',height:'auto',modal:true,closeText:Drupal.t('Close the window'),classes:{"ui-dialog":"ameli-localisation-dialog","localisation_txt":"localisation_txt"},close:function(){self.resetStep();self.dialog.find(".step1 form button").prop("disabled",true);$('body').removeClass('modal-open');}});this.dialog.find(".step1 form input[type=\"text\"]").on("blur input",function(event){self.checkFocusOnLocalisationPopin(this);});this.dialog.find(".step1 form input[type=\"text\"]").trigger('input');this.dialog.find(".step1 form").on("submit",function(event){event.preventDefault();var cp=self.dialog.find(".step1 form input[name=\"postal_code\"]").val();var res=self.checkPostalCode(cp);if(res!==false)if(res.length>1)self.showStep(2,res);else self.showStep(3,res);else{self.dialog.find(".step1 .formErrors").show();self.dialog.find(".step1 .formHelp").hide();}self.positionCenter();});this.dialog.find(".step2 form").on("submit",function(event){event.preventDefault();var res=self.checkLocalisation();if(res!==false)self.showStep(3,res);self.positionCenter();});this.dialog.find(".step3 form").on("submit",function(event){event.preventDefault();var current_localisation=self.localisationCookieData.localisation;self.localisationCookieData.localisation=self.dialog.find('.step3 form input[name="localisation"]').val();Cookies.set('ameli_localisation',self.localisationCookieData.localisation,{expires:self.getExpirationCookieDate(),path:'/',sameSite:'Lax',secure:true});var next_localisation=self.localisationCookieData.localisation;self.dialog.dialog('close');var pathname=document.location.pathname;if(current_localisation!==next_localisation){pathname=pathname.split('/');if(pathname[1]!==undefined&&self.data.reverse['/'+pathname[1]]!==undefined)pathname=pathname.slice(2);else pathname=pathname.slice(1);pathname='/'+pathname.join('/');if(self.data.terms[next_localisation]!==undefined)pathname=self.data.terms[next_localisation].prefix+(pathname!=='/'?pathname:'');}document.location.href=pathname;});this.dialog.find('.dialog-reset a').on('click',function(event){event.preventDefault();self.resetStep();self.positionCenter();});this.addTriggerElement(elem);if(this.checkAutoOpen())this.open();else this.showStep(1);};Drupal.behaviors.ameli_localisation={attach:function(context,settings){$(once('ameli_localisation_modal','.localisation_txt_js',context)).each(function(){var cookie=Drupal.ameli_localisation_cookie();if(cookie.localisation){$('.local-choice .zone-choice',this).show().text(drupalSettings.ameli_localisation.terms[cookie.localisation].label);$('.local-open-dialog',this).text($(this).data('btnLabelLocalized'));$('.no-localisation',this).hide();}else{$('.local-choice .zone-label',this).text($(this).data('label'));$('.local-open-dialog',this).text($(this).data('btnLabel'));$('.no-localisation',this).show();}if(!Drupal.ameli_localisation_instance)Drupal.ameli_localisation_instance=new Drupal.ameli_localisation(this,drupalSettings.ameli_localisation);else Drupal.ameli_localisation_instance.addTriggerElement(this);var localisation_regen=Cookies.get('ameli_localisation_regen');if(localisation_regen===undefined){if(cookie.localisation)Cookies.set('ameli_localisation',cookie.localisation,{expires:Drupal.ameli_localisation_instance.getExpirationCookieDate(),path:'/',sameSite:'Lax',secure:true});Cookies.set('ameli_localisation_counter',cookie.counter,{expires:Drupal.ameli_localisation_instance.getExpirationCookieDate(),path:'/',sameSite:'Lax',secure:true});var date_now=new Date();Cookies.set('ameli_localisation_regen',1,{expires:date_now.getDay()+5*365,path:'/',sameSite:'Lax',secure:true});}});}};})(jQuery,Drupal,drupalSettings,Cookies);;
